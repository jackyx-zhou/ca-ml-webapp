(this["webpackJsonpca-ml-webapp"]=this["webpackJsonpca-ml-webapp"]||[]).push([[0],{437:function(e,t,n){},447:function(e,t){},448:function(e,t){},456:function(e,t){},540:function(e,t){},541:function(e,t){},542:function(e,t){},550:function(e,t){},554:function(e,t,n){"use strict";n.r(t);var a=n(3),i=n.n(a),r=n(58),s=n.n(r),c=(n(437),n(7)),o=n(130),l=n(20),u=n(26),d=n(607),j=n(91),h=n(634),b=n(624),m=n(625),p=n(611),f=n(623),g=n(299),O=n(627),x=n(626),v=n(410),y=n.n(v),w=n(412),S=n.n(w),k=n(411),C=n.n(k),N=n(628),T=n(629),B=n(630),R=n(413),I=n.n(R),A=n(414),L=n.n(A),M=n(415),F=n.n(M),z=n(416),W=n.n(z),G=n(172),E=n(68),P=n(632),D=n(16);function Y(e){return Object(D.jsx)(g.a,{component:"span",variant:"body1",paragraph:!0,children:Object(D.jsx)(P.a,{fontWeight:"fontWeightMedium",textAlign:"left",px:"5%",py:"1%",children:e.children})})}var X=n(557),_=n(608),U=Object(d.a)((function(e){return{root:{flexGrow:1},paper:{padding:e.spacing(2),textAlign:"center",color:e.palette.text.secondary}}}));var H=function(e){var t=U();return Object(D.jsx)("div",{className:t.root,children:Object(D.jsxs)(_.a,{container:!0,spacing:3,children:[Object(D.jsx)(_.a,{item:!0,xs:12,sm:6,children:Object(D.jsx)(X.a,{className:t.paper,children:e.left})}),Object(D.jsx)(_.a,{item:!0,xs:12,sm:6,children:Object(D.jsx)(X.a,{className:t.paper,children:e.right})})]})})};function V(){var e=Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)(g.a,{variant:"h4",gutterBottom:!0,children:"Cellular Automata"}),Object(D.jsxs)(Y,{children:["A cellular automaton is a collection of cells of a finite number of states (such as on and off) on a grid of specified shape that evolves through a number of discrete time steps according to a set of rules ",Object(D.jsx)("em",{children:"based on the states of neighboring cells"}),". The rules are then applied iteratively for as many time steps as desired.",Object(D.jsx)("br",{}),Object(D.jsx)("br",{}),"The concept was originally discovered in the 1940s by Stanislaw Ulam and John von Neumann. It was not until the 1970s and Conway's Game of Life, a two-dimensional cellular automaton, that interest in the subject expanded beyond academia. In the 1980s, Stephen Wolfram engaged in a systematic study of one-dimensional cellular automata, or what he calls elementary cellular automata; his research assistant Matthew Cook showed that one of these rules is Turing-complete. Wolfram published A New Kind of Science in 2002, claiming that cellular automata have applications in many fields of science."]}),Object(D.jsx)("img",{alt:"",style:{maxWidth:"100%"},src:"https://miro.medium.com/max/1024/1*pNLSLasaYXb9wgBPpGXZSw.gif"})]}),t=Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)(g.a,{variant:"h4",gutterBottom:!0,children:"Machine Learning"}),Object(D.jsxs)(Y,{children:["Machine learning is an application of artificial intelligence (AI) that provides systems the ability to automatically learn and improve from experience without being explicitly programmed. ",Object(D.jsx)("br",{}),Object(D.jsxs)("strong",{children:[Object(D.jsx)("br",{}),"In this project, my main aim is to try and see if cellular automata of different scale (elementary/2-dimensional) and of different complexities (single/multi-channel) can be simulated and learned by various artificial neural networks architectures, thus exploring the relationships between these two kinds of self-evolving computational models.",Object(D.jsx)("br",{}),Object(D.jsx)("br",{})]}),"The project has been heavily inspired by the paper ",Object(D.jsx)("a",{href:"https://distill.pub/2020/growing-ca/",children:"Growing Neural Cellular Automata"})," by researchers at Google and Allen Discovery Center. My ultimate aim is to try and create a simple texture synthesizer that can be trained and run with low hardware requirements using the model outlined in the Google paper."]}),Object(D.jsx)("img",{alt:"",style:{maxWidth:"80%"},src:"https://miro.medium.com/max/3000/1*n3TBO5i8hrYAujlhiHoE_w.gif"})]});return Object(D.jsx)(H,{left:e,right:t})}var q=n(12),J=n(631),K=n(612),Z=n(417),Q=n(609),$=Object(Z.a)(Q.a)({maxWidth:"100%",marginBottom:20}),ee=n(326),te=Object(d.a)((function(e){return{image:{position:"relative",flexDirection:"column","&:hover":{zIndex:1}}}}));function ne(e){var t="/ca-ml-webapp/caButtons/"+e.id+"on.png",n="/ca-ml-webapp/caButtons/"+e.id+"off.png",a=e.toggle,i=te();return Object(D.jsxs)(ee.a,{focusRipple:!0,className:i.image,focusVisibleClassName:i.focusVisible,id:e.id,index:e.index,toggle:e.toggle?1:void 0,onClick:e.onClick,children:[Object(D.jsx)("img",{src:a?t:n,alt:e.id+" state"}),Object(D.jsx)("br",{}),Object(D.jsxs)(g.a,{variant:"button",children:[" ",a?1:0," "]})]})}var ae=n(287),ie=n.n(ae);function re(e,t){var n=64;return new ie.a((function(a){function i(e){var t=this;this.w=Math.floor(a.width/n),this.cells=new Array(n);for(var i=0;i<this.cells.length;i++)this.cells[i]=0;this.cells[this.cells.length/2]=1,this.generation=0,this.ruleset=e.toString(2).padStart(8,"0").split("").map((function(e){return parseInt(e)})),this.generate=function(){for(var e=[],n=0;n<t.cells.length;n++)e[n]=0;for(var a=1;a<t.cells.length-1;a++){var i=t.cells[a-1],r=t.cells[a],s=t.cells[a+1];e[a]=t.rules(i,r,s)}t.cells=e,t.generation++},this.display=function(){for(var e=0;e<this.cells.length;e++)1===this.cells[e]?a.fill(0):a.fill(200),a.noStroke(),a.rect(e*this.w,this.generation*this.w,this.w,this.w)},this.rules=function(e,t,n){return 1===e&&1===t&&1===n?this.ruleset[0]:1===e&&1===t&&0===n?this.ruleset[1]:1===e&&0===t&&1===n?this.ruleset[2]:1===e&&0===t&&0===n?this.ruleset[3]:0===e&&1===t&&1===n?this.ruleset[4]:0===e&&1===t&&0===n?this.ruleset[5]:0===e&&0===t&&1===n?this.ruleset[6]:0===e&&0===t&&0===n?this.ruleset[7]:0}}var r;a.setup=function(){a.createCanvas(.8*e.offsetWidth,.8*e.offsetWidth),r=new i(t),a.resizeCanvas(n*r.w,n*r.w),a.background(255)},a.draw=function(){r.display(),r.generation<a.height/r.w&&r.generate()},a.windowResized=function(){a.resizeCanvas(.8*e.offsetWidth,.8*e.offsetWidth),r=new i(t),a.resizeCanvas(n*r.w,n*r.w),a.background(255)}}),e)}var se=Object(q.a)(Array(8).keys()).reverse().map((function(e){return e.toString(2).padStart(3,"0")}));function ce(e){var t=e.ruleNum,n=e.setRuleNum,i=Object(a.useState)(!1),r=Object(c.a)(i,2),s=r[0],o=r[1],l=Object(a.useState)(Object(q.a)(Array(8).fill(!1))),u=Object(c.a)(l,2),d=u[0],j=u[1],h=Object(a.useRef)(null),b=Object(a.useState)(null),m=Object(c.a)(b,2),p=m[0],f=m[1],g=function(e){var t=e.currentTarget,a=Object(q.a)(d);a[parseInt(t.getAttribute("index"))]=!t.getAttribute("toggle"),j(a),n(function(e){return Object(q.a)(e).reverse().reduce((function(e,t,n){return e+t*Math.pow(2,n)}),0)}(a))};return Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)($,{children:se.map((function(e,t){return Object(D.jsx)(ne,{id:e,index:t,toggle:d[t]?1:void 0,onClick:g},t)}))}),Object(D.jsx)($,{children:Object(D.jsx)(J.a,{error:s,id:"rule-num-inpput",label:"Rule Number",type:"number",value:t,variant:"outlined",onChange:function(e){var t=e.target.value;isNaN(t)||(t=parseInt(t))<0||t>255?o(!0):(o(!1),n(t),j(t.toString(2).padStart(8,"0").split("").map((function(e){return!!parseInt(e)}))))},helperText:s?"Only number between 0 and 255 allowed!":"Suggestion: 30, 135, 193"})}),Object(D.jsx)($,{children:Object(D.jsx)(K.a,{variant:"contained",color:"primary",onClick:function(e){p&&p.remove(),f(re(h.current,t))},children:"Visualise"})}),Object(D.jsx)($,{ref:h})]})}var oe,le,ue=n(636),de=n(610),je=n(59),he=n(2),be=n.n(he),me=n(17),pe=n(35);function fe(){return(fe=Object(me.a)(be.a.mark((function e(t,n){var a,i,r;return be.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return le&&le.dispose(),a=["loss","acc"],i={name:"Model Training",tab:"1D CA"},r=Object(o.a)(Object(o.a)({},je.show.fitCallbacks(i,a)),{},{onEpochEnd:function(e,n){n.acc>.99&&(console.log("Training stopped at "+e+" epoch"),t.stopTraining=!0)}}),le=n.toString(2).padStart(8,"0").split("").map(Number),le=pe.u(le),e.abrupt("return",t.fit(oe,le,{epochs:5e3,callbacks:r}));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ge(e){var t=e.ruleNum,n=Object(a.useState)(0),i=Object(c.a)(n,2),r=i[0],s=i[1],o=Object(a.useState)(null),l=Object(c.a)(o,2),u=l[0],d=l[1],j=Object(a.useState)(!1),h=Object(c.a)(j,2),b=h[0],m=h[1],p=Object(a.useRef)(null),f=Object(a.useState)(null),O=Object(c.a)(f,2),x=O[0],v=O[1],y={name:"Model summary",tab:"1D CA"},w={name:"Hidden Layer Summary",tab:"1D CA"},S={name:"Hidden Layer Summary Post Training",tab:"1D CA"};return Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)($,{children:Object(D.jsx)(K.a,{variant:"contained",color:"secondary",onClick:function(e){je.visor().open()},children:"Show tensorflow board"})}),Object(D.jsxs)($,{children:[Object(D.jsx)(g.a,{id:"hidden-unit-slider",gutterBottom:!0,children:"Units in hidden layer"}),Object(D.jsxs)(_.a,{container:!0,spacing:2,justify:"center",children:[Object(D.jsx)(_.a,{item:!0,children:Object(D.jsx)(ue.a,{value:"number"===typeof r?r:0,onChange:function(e,t){s(t)},"aria-labelledby":"hidden-unit-slider",style:{width:64},min:0,max:32})}),Object(D.jsx)(_.a,{item:!0,children:Object(D.jsx)(de.a,{value:r,margin:"dense",onChange:function(e){s(""===e.target.value?"":Number(e.target.value))},onBlur:function(){r<0?s(0):r>32&&s(32)},inputProps:{min:0,max:32,type:"number","aria-labelledby":"hidden-unit-slider"}})}),Object(D.jsx)(_.a,{item:!0,children:Object(D.jsx)(K.a,{variant:"contained",color:"primary",onClick:function(e){var t=function(e){pe.e();var t=pe.p();t.add(pe.g.inputLayer({inputShape:[3]})),e>0&&t.add(pe.g.dense({units:e,activation:"relu"})),t.add(pe.g.dense({units:1,activation:"sigmoid"}));var n=pe.z.sgd(.2);return t.compile({optimizer:n,loss:"binaryCrossentropy",metrics:["accuracy"]}),t}(r);je.show.modelSummary(y,t),je.show.layer(w,t.getLayer(void 0,1)),je.visor().open(),d(t)},children:"Build Model"})})]})]}),u?Object(D.jsx)($,{children:Object(D.jsxs)(_.a,{container:!0,spacing:2,justify:"center",children:[Object(D.jsx)(_.a,{item:!0,children:Object(D.jsx)(K.a,{variant:"contained",color:"primary",onClick:function(e){var t=function(e){return pe.x((function(){return e.predict(oe).dataSync().map((function(e){return Number(e>.5)}))}))}(u).reverse().reduce((function(e,t,n){return e+t*Math.pow(2,n)}),0);console.log(t),x&&x.remove(),v(re(p.current,t))},children:"Visualise"})}),Object(D.jsx)(_.a,{item:!0,children:Object(D.jsx)(K.a,{variant:"contained",color:"primary",onClick:function(e){(function(e,t){return fe.apply(this,arguments)})(u,t).then((function(){m(!1),je.show.layer(S,u.getLayer(void 0,1))})),je.visor().open(),m(!0)},disabled:b,children:"Train Model"})}),b?Object(D.jsx)(_.a,{item:!0,children:Object(D.jsx)(K.a,{variant:"contained",color:"secondary",onClick:function(e){u.stopTraining=!0,m(!1),je.show.layer(S,u.getLayer(void 0,1))},children:"Stop training"})}):null]})}):null,Object(D.jsx)($,{ref:p,children:Object(D.jsx)(D.Fragment,{})})]})}function Oe(){var e=Object(a.useState)(0),t=Object(c.a)(e,2),n=t[0],i=t[1],r=Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)(g.a,{variant:"h4",gutterBottom:!0,children:"Elementary CA"}),Object(D.jsxs)(Y,{children:[Object(D.jsx)("a",{href:"https://www.cantorsparadise.com/elementary-cellular-automaton-e27e3d1008d9",children:"Wolfram's elementary cellular automata"})," are one-dimensional, constructed with two possible values for each cell (0 or 1), and rules that depend only on itself and the nearest neighbor values.",Object(D.jsx)("br",{}),'Below is a simple demo you can play around with different rule set by either clicking on individual rule cells or input the rule number directly. The top row in the grid is initialised with only the middle cell "on", and every row below is 1 timestep after evolving from its row above.']}),Object(D.jsx)(ce,{ruleNum:n,setRuleNum:i})]}),s=Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)(g.a,{variant:"h4",gutterBottom:!0,children:"Multi-layer Perceptron"}),Object(D.jsxs)(Y,{children:["In this simple demo, we use a simple multilayer perceptron model to learn the CA update rule. Notice this problem is a non-linearly separable problem like the XOR problem, so if there's no hidden layer (hidden layer units slider set to 0), the single output perceptron would not be able to converge to a solution.",Object(D.jsx)("br",{}),"You can play around and build models, change hyperparameters, and train the model to learn the CA rule you have specified on the CA side. Compare the visualisation result before and after the training is complete."]}),Object(D.jsx)("img",{alt:"mlp model",style:{maxWidth:"80%"},src:"https://ars.els-cdn.com/content/image/1-s2.0-S2405656118301020-gr1.jpg"}),Object(D.jsx)(ge,{ruleNum:n})]});return Object(D.jsx)(H,{left:r,right:s})}function xe(e){var t=this,n=e,a=e;function i(e,t,i){for(var r=0,s=-1;s<2;s++)for(var c=-1;c<2;c++){var o=(i+c+a)%a;r+=e[(t+s+n)%n][o]}return r-=e[t][i]}this.grid=function(e,t){for(var n=ve(e,t),a=0;a<e;a++)for(var i=0;i<t;i++)n[a][i]=0;return n}(n,a),this.randomInitialise=function(){t.grid=function(e,t){for(var n=ve(e,t),a=0;a<e;a++)for(var i=0;i<t;i++)n[a][i]=Math.floor(2*Math.random());return n}(n,a)},this.computeNext=function(){for(var e=ve(n,a),r=0;r<n;r++)for(var s=0;s<a;s++){var c=t.grid[r][s],o=i(t.grid,r,s);e[r][s]=0===c&&3===o?1:1===c&&(o<2||o>3)?0:c}t.grid=e}}function ve(e,t){for(var n=new Array(e),a=0;a<n.length;a++)n[a]=new Array(t);return n}function ye(e){var t,n=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=28,s=r,c=r;a||(this.gol=new xe(r)),this.isRunning=!1;var o=function(o){o.setup=function(){o.createCanvas(.6*e.offsetWidth,.6*e.offsetWidth),t=o.width/r,o.resizeCanvas(r*t,r*t),o.background(0),o.frameRate(15)},o.draw=function(){o.background(255);for(var e=0;e<s;e++)for(var r=0;r<c;r++){var l=e*t,u=r*t;if(a){var d=0,j=0;Math.abs(i[e][r]-a[e][r])<=.25?j=255:d=255;var h=o.map(a[e][r],0,1,0,255);o.fill(d,j,0,h),o.strokeWeight(.5),o.stroke(200)}else 1===n.gol.grid[e][r]?(o.fill(0),o.noStroke()):(o.noFill(),o.strokeWeight(2),o.stroke(0));o.rect(l,u,t,t)}n.isRunning&&n.gol.computeNext()},o.mouseClicked=function(){if(!n.isRunning&&!a){var e=Math.floor(o.mouseX/t),i=Math.floor(o.mouseY/t);e>=0&&e<c&&i>=0&&i<s&&(n.gol.grid[e][i]=1-n.gol.grid[e][i])}},o.mouseDragged=function(){if(!n.isRunning&&!a){var e=Math.floor(o.mouseX/t),i=Math.floor(o.mouseY/t);e>=0&&e<c&&i>=0&&i<s&&(n.gol.grid[e][i]=1)}},o.windowResized=function(){o.createCanvas(.6*e.offsetWidth,.6*e.offsetWidth),t=o.width/r,o.resizeCanvas(r*t,r*t),o.background(0)}};this.p5=new ie.a(o,e),this.reset=function(){n.gol=new xe(r)}}function we(e){var t=e.golp5,n=e.setGolp5,i=e.isp5Running,r=e.setisp5Running,s=Object(a.useRef)(null);Object(a.useEffect)((function(){n((function(e){return e||new ye(s.current)}))}),[]);return Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)($,{ref:s}),Object(D.jsx)($,{children:Object(D.jsxs)(_.a,{container:!0,spacing:3,justify:"center",children:[Object(D.jsxs)(_.a,{container:!0,item:!0,spacing:2,justify:"space-evenly",children:[Object(D.jsx)(_.a,{item:!0,children:Object(D.jsx)(K.a,{variant:"contained",color:"primary",onClick:function(e){t.reset()},children:"Clear board"})}),Object(D.jsx)(_.a,{item:!0,children:Object(D.jsx)(K.a,{variant:"contained",color:"primary",onClick:function(e){t.gol.randomInitialise()},children:"Random"})})]}),t?Object(D.jsxs)(_.a,{container:!0,item:!0,spacing:2,justify:"center",children:[Object(D.jsx)(_.a,{item:!0,children:Object(D.jsx)(K.a,{variant:"contained",color:"secondary",onClick:function(e){t.isRunning=!t.isRunning,r(t.isRunning)},children:i?"Pause":"Run"})}),Object(D.jsx)(_.a,{item:!0,children:Object(D.jsx)(K.a,{variant:"contained",color:"secondary",onClick:function(e){i&&(t.isRunning=!1,r(t.isRunning)),t.gol.computeNext()},children:"Step"})})]}):null]})})]})}oe=(oe=Object(q.a)(Array(8).keys()).reverse().map((function(e){return e.toString(2).padStart(3,"0")}))).map((function(e){return e.split("").map(Number)})),oe=pe.u(oe);var Se=n(1),ke=n(9),Ce=n(13),Ne=n(14),Te=function(e){Object(Ce.a)(n,e);var t=Object(Ne.a)(n);function n(){return Object(Se.a)(this,n),t.call(this,{})}return Object(ke.a)(n,[{key:"computeOutputShape",value:function(e){var t=Object(q.a)(e);return t[1]+=2,t[2]+=2,t}},{key:"call",value:function(e,t){var n=(e=e[0]).shape[1],a=e.slice([0,n-1,0],[-1,1,-1]),i=e.slice([0,0,0],[-1,1,-1]),r=pe.b([a,e,i],1),s=r.slice([0,0,n-1],[-1,-1,1]),c=r.slice([0,0,0],[-1,-1,1]);return pe.b([s,r,c],2)}},{key:"getClassName",value:function(){return"PeriodicPadding"}}]),n}(pe.g.Layer);function Be(e,t){var n=this,a=100,i=28;this.trainXs=new Array(a),this.trainYs=new Array(a);for(var r=0;r<a;r++){var s=new xe(i);s.randomInitialise(),this.trainXs[r]=s.grid,s.computeNext(),this.trainYs[r]=s.grid}this.trainXs=pe.v(this.trainXs).reshape([a,i,i,1]),this.trainYs=pe.v(this.trainYs).reshape([a,784,1]),this.model=function(){pe.e();var n=pe.p();n.add(pe.g.inputLayer({inputShape:[i,i,1]})),n.add(new Te),n.add(pe.g.conv2d({filters:e,kernelSize:3,padding:"valid",activation:"relu"})),n.add(pe.g.reshape({targetShape:[-1,e]})),t>0&&n.add(pe.g.dense({units:t,activation:"relu"}));n.add(pe.g.dense({units:1,activation:"sigmoid"}));var a=pe.z.adam(.01);return n.compile({optimizer:a,loss:"binaryCrossentropy",metrics:["accuracy"]}),n}(),this.isTraining=!1,this.train=function(){var e=Object(o.a)(Object(o.a)({},je.show.fitCallbacks({name:"Model Training",tab:"Game of Life"},["loss","acc"])),{},{onBatchEnd:function(e,t){t.loss<.01&&(n.model.stopTraining=!0)}});return n.model.fit(n.trainXs,n.trainYs,{epochs:100,callbacks:e})},this.doPrediction=function(e){return pe.x((function(){e=pe.w(e).reshape([1,i,i,1]);var t=n.model.predict(e);return t=t.reshape([i,i])}))}}function Re(e){var t=e.golp5,n=e.setisp5Running,i=Object(a.useState)(10),r=Object(c.a)(i,2),s=r[0],o=r[1],l=Object(a.useState)(20),u=Object(c.a)(l,2),d=u[0],j=u[1],h=Object(a.useState)(null),b=Object(c.a)(h,2),m=b[0],p=b[1],f=Object(a.useState)(!1),O=Object(c.a)(f,2),x=O[0],v=O[1],y=Object(a.useState)(null),w=Object(c.a)(y,2),S=w[0],k=w[1],C=Object(a.useRef)(null),N={name:"Model summary",tab:"Game of Life"},T={name:"Hidden Layer Summary",tab:"Game of Life"},B={name:"Hidden Layer Summary Post Training",tab:"Game of Life"};return Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)($,{children:Object(D.jsx)(K.a,{variant:"contained",color:"secondary",onClick:function(e){je.visor().open()},children:"Show tensorflow board"})}),Object(D.jsxs)($,{children:[Object(D.jsx)(g.a,{variant:"h6",gutterBottom:!0,children:Object(D.jsx)("b",{children:"Model Configuration"})}),Object(D.jsx)(_.a,{container:!0,justify:"center",alignItems:"center",children:Object(D.jsxs)(_.a,{container:!0,item:!0,direction:"column",justify:"center",alignItems:"center",children:[Object(D.jsxs)(_.a,{container:!0,item:!0,justify:"center",alignItems:"center",spacing:3,children:[Object(D.jsx)(g.a,{id:"conv-filter-slider",gutterBottom:!0,children:"Number of Convolution Filters:"}),Object(D.jsx)(_.a,{item:!0,children:Object(D.jsx)(ue.a,{value:"number"===typeof s?s:10,onChange:function(e,t){o(t)},"aria-labelledby":"conv-filter-slider",style:{width:100},min:1,max:32})}),Object(D.jsx)(_.a,{item:!0,children:Object(D.jsx)(de.a,{value:s,margin:"dense",onChange:function(e){o(""===e.target.value?"":Number(e.target.value))},onBlur:function(){(s<1||s>32)&&o(10)},inputProps:{min:1,max:32,type:"number","aria-labelledby":"conv-filter-slider"}})})]}),Object(D.jsxs)(_.a,{container:!0,item:!0,justify:"center",alignItems:"center",spacing:3,children:[Object(D.jsx)(g.a,{id:"dense-unit-slider",gutterBottom:!0,children:"Number of Dense Layer Units :"}),Object(D.jsx)(_.a,{item:!0,children:Object(D.jsx)(ue.a,{value:"number"===typeof d?d:0,onChange:function(e,t){j(t)},"aria-labelledby":"dense-unit-slider",style:{width:100},min:0,max:32})}),Object(D.jsx)(_.a,{item:!0,children:Object(D.jsx)(de.a,{value:d,margin:"dense",onChange:function(e){j(""===e.target.value?"":Number(e.target.value))},onBlur:function(){(d<0||d>32)&&j(20)},inputProps:{min:0,max:32,type:"number","aria-labelledby":"dense-unit-slider"}})})]}),Object(D.jsx)(_.a,{item:!0,children:Object(D.jsx)(K.a,{variant:"contained",color:"primary",onClick:function(e){var t=new Be(s,d);p(t),je.show.modelSummary(N,t.model),je.show.layer(T,t.model.getLayer(void 0,2)),je.visor().open()},children:"Build Model"})})]})})]}),m?Object(D.jsx)($,{children:Object(D.jsxs)(_.a,{container:!0,spacing:2,justify:"center",children:[Object(D.jsx)(_.a,{item:!0,children:Object(D.jsx)(K.a,{variant:"contained",color:"primary",onClick:function(e){t.isRunning=!1,n(!1);var a=m.doPrediction(t.gol.grid);a=a.arraySync(),t.gol.computeNext();var i=t.gol.grid;S&&S.p5.remove(),k(new ye(C.current,a,i))},children:"Predict Next Step"})}),Object(D.jsx)(_.a,{item:!0,children:Object(D.jsx)(K.a,{variant:"contained",color:"primary",onClick:function(e){m.train().then((function(){v(!1),je.show.layer(B,m.model.getLayer(void 0,2))})),je.visor().open(),v(!0)},disabled:x,children:"Train Model"})}),x?Object(D.jsx)(_.a,{item:!0,children:Object(D.jsx)(K.a,{variant:"contained",color:"secondary",onClick:function(e){m.model.stopTraining=!0,v(!1),je.show.layer(B,m.model.getLayer(void 0,2))},children:"Stop training"})}):null]})}):null,Object(D.jsx)($,{ref:C}),S?Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)("span",{style:{color:"green"},children:Object(D.jsx)("b",{children:"GREEN"})})," cells indicate correct predictions",Object(D.jsx)("br",{}),Object(D.jsx)("span",{style:{color:"red"},children:Object(D.jsx)("b",{children:"RED"})})," cells indicate wrong predictions.",Object(D.jsx)("br",{})]}):null]})}function Ie(){var e=Object(a.useState)(null),t=Object(c.a)(e,2),n=t[0],i=t[1],r=Object(a.useState)(!1),s=Object(c.a)(r,2),o=s[0],l=s[1],u=Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)(g.a,{variant:"h4",gutterBottom:!0,children:"Conway's Game of Life"}),Object(D.jsxs)(Y,{children:[Object(D.jsx)("a",{href:"https://mathworld.wolfram.com/GameofLife.html",children:"Conway's Game of Life"})," is a two-dimensional cellular automaton, invented by John H. Conway and popularized in Martin Gardner's Scientific American column starting in October 1970.",Object(D.jsx)("br",{}),Object(D.jsx)("b",{children:Object(D.jsx)("em",{children:"RULES"})}),Object(D.jsx)("br",{}),"For a space that is populated:",Object(D.jsx)("br",{}),"1. Each cell with one or no neighbors dies, as if by solitude.",Object(D.jsx)("br",{}),"2. Each cell with four or more neighbors dies, as if by overpopulation.",Object(D.jsx)("br",{}),"3. Each cell with two or three neighbors survives.",Object(D.jsx)("br",{}),"For a space that is empty or unpopulated:",Object(D.jsx)("br",{}),"Each cell with three neighbors becomes populated.",Object(D.jsx)("br",{}),Object(D.jsx)("br",{}),"Below is a simple demo you can play around with by clicking on each cell on the grid to populate or empty it. You can click run to let the game plays out till a stable state is reached, or you can click step to let it run one step at a time. Try making some of the listed patterns below and see how it evolves!"]}),Object(D.jsx)(we,{golp5:n,setGolp5:i,isp5Running:o,setisp5Running:l}),Object(D.jsx)("img",{alt:"",style:{maxWidth:"60%"},src:"https://img.itch.zone/aW1nLzIxNTk1NTYucG5n/original/nS1Wxk.png"})]}),d=Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)(g.a,{variant:"h4",gutterBottom:!0,children:"Convolutional Neural Network"}),Object(D.jsxs)(Y,{children:[Object(D.jsx)("a",{href:"https://towardsdatascience.com/a-comprehensive-guide-to-convolutional-neural-networks-the-eli5-way-3bd2b1164a53",children:"Convolutional neural network"}),"  applies a series of local convolutions via a trainable \u201ckernel\u201d to an input multichannel image. The same kernel is applied to all pixels in the image, and each convolutional layer consolidates information within a fixed local radius of each pixel in the input image depending on the kernel size.",Object(D.jsx)("br",{}),"The primary analogy between cellular automata and traditional convolutional neural networks arises from (1) the locality of the dynamics, and (2) simultaneous temporal updating of all spatial points. The single-neighborhood rule operator in CA can, in this way, be implemented as a convolutional operator as part of a CNN, allowing it to be applied synchronously to all pixel neighborhoods in an input image.",Object(D.jsx)("br",{}),Object(D.jsx)("br",{}),"Below is an example implementation of an in-browser convolutional neural network. You can train it and then use it to predict the next step of the grid on the other panel."]}),Object(D.jsx)("img",{src:"/ca-ml-webapp/convolution.png",style:{maxWidth:"100%"},alt:"convolution diagram"}),Object(D.jsx)(Re,{golp5:n,setisp5Running:l})]});return Object(D.jsx)(H,{left:u,right:d})}function Ae(e){e.textureImage;var t=e.setTextureImage,n=e.uploadedImage;return Object(D.jsxs)(D.Fragment,{children:[Object(D.jsxs)($,{children:[Object(D.jsx)("input",{accept:"image/*",id:"contained-button-file",type:"file",onChange:function(e){var a=e.target.files[0];if(console.log(a),a){t(a);var i=new FileReader,r=n.current;r.file=a,i.onload=function(e){r.src=e.target.result},i.readAsDataURL(a)}},style:{display:"None"}}),Object(D.jsx)("label",{htmlFor:"contained-button-file",children:Object(D.jsx)(K.a,{variant:"contained",color:"primary",component:"span",children:"Upload"})})]}),Object(D.jsx)("img",{alt:"",style:{maxWidth:"100%"},ref:n,src:"/ca-ml-webapp/example_pattern.jpg"})]})}var Le=function(e){return pe.C([e,64,64,12])},Me=function(e){return pe.r(e,[0,0,0,0],[-1,-1,-1,3])},Fe=function(e){Object(Ce.a)(n,e);var t=Object(Ne.a)(n);function n(){var e,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return Object(Se.a)(this,n),(e=t.call(this,{})).angle=a,e}return Object(ke.a)(n,[{key:"computeOutputShape",value:function(e){var t=Object(q.a)(e);return t[3]=48,console.log(t),t}},{key:"call",value:function(e,t){var n=this;return pe.x((function(){var t=pe.m([0,1,0],[0,1,0]),a=pe.m([1,2,1],[-1,0,1]).div(pe.o(8)),i=pe.A(a),r=pe.m([1,2,1],[1,2,1]).div(pe.o(8));r=r.sub(pe.m([0,2,0],[0,1,0]));var s=[pe.c(n.angle),pe.q(n.angle)],c=s[0],o=s[1],l=pe.u([t,c.mul(a).sub(o.mul(i)),o.mul(a).add(c.mul(i)),r],-1);l=l.expandDims(2),l=pe.y(l,[1,1,12,1]),e=e[0];var u=[];return pe.B(e).forEach((function(e){var t=pe.d(e,l,1,"same");u.push(t)})),pe.u(u)}))}},{key:"getClassName",value:function(){return"Perception"}}]),n}(pe.g.Layer),ze=function(e){Object(Ce.a)(n,e);var t=Object(Ne.a)(n);function n(e){var a;return Object(Se.a)(this,n),(a=t.call(this,{})).fire_rate=e,a}return Object(ke.a)(n,[{key:"call",value:function(e,t){var n=this;return pe.x((function(){var t=(e=e[0]).shape,a=pe.l([1-n.fire_rate,n.fire_rate],t[0]*t[1]*t[2]).reshape([t[0],t[1],t[2],1]);return pe.k(e,a)}))}},{key:"getClassName",value:function(){return"Masking"}}]),n}(pe.g.Layer);pe.g.Layer;function We(e){var t=this;this.model=function(){var e=pe.g.conv2d({filters:96,kernelSize:1,padding:"valid",activation:"relu",useBias:!0}),t=pe.g.conv2d({filters:12,kernelSize:1,padding:"valid",activation:null,kernelInitializer:"zeros"}),n=new Fe(0),a=pe.f({shape:[64,64,12]}),i=n.apply(a),r=e.apply(i);r=t.apply(r);var s=new ze(.55).apply(r),c=pe.g.add().apply([a,s]);return pe.j({inputs:a,outputs:c})}(),this.loss_log=[],this.isTraining=!1,this.epochs=-1;var n=pe.y(e.expandDims(0),[2,1,1,1]);this.trainStep=function(){return pe.x((function(){var e=Le(2),a=(Object(o.a)({},je.show.fitCallbacks({name:"Model Training",tab:"Texture Synth"},["loss"])),pe.n([],64,96,"int32"));a=a.dataSync()[0];var i=pe.z.adam(.002),r=i.computeGradients((function(){for(var i=0;i<a;i++)e=t.model.predict(e);var r=pe.i.meanSquaredError(n,Me(e)).sum();return t.loss_log.push(r.dataSync()),r.print(),r}));i.applyGradients(r.grads)}))},this.visualiseResult=function(e){pe.x((function(){for(var n=Le(1),a=0;a<96;a++)n=t.model.predict(n);pe.a.toPixels(pe.t(Me(n).clipByValue(0,1)),e.current)}))},this.train=function(e,n,a){return setInterval((function(){t.epochs%10===0&&(n(t.epochs),a(t.loss_log[t.epochs])),t.epochs%50===0&&t.visualiseResult(e),console.log("Epoch: "+t.epochs),t.trainStep(),t.epochs++}),0)}}function Ge(e){var t=e.uploadedImage,n=Object(a.useState)(null),i=Object(c.a)(n,2),r=i[0],s=i[1],o=Object(a.useState)(null),l=Object(c.a)(o,2),u=l[0],d=l[1],j=Object(a.useState)(!1),h=Object(c.a)(j,2),b=(h[0],h[1]),m=Object(a.useState)(null),p=Object(c.a)(m,2),f=p[0],O=p[1],x=Object(a.useState)(null),v=Object(c.a)(x,2),y=v[0],w=v[1],S=Object(a.useState)(null),k=Object(c.a)(S,2),C=k[0],N=k[1],T=Object(a.useRef)(null),B={name:"Model summary",tab:"Texture Synth"};return Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)($,{children:Object(D.jsx)(K.a,{variant:"contained",color:"secondary",onClick:function(e){je.visor().open()},children:"Show tensorflow board"})}),Object(D.jsx)($,{children:Object(D.jsx)(K.a,{variant:"contained",color:"primary",onClick:function(e){if(t.current.src){var n=pe.a.fromPixels(t.current).resizeBilinear([64,64]).toFloat().div(pe.o(255));s(n),console.log(n),pe.a.toPixels(n,T.current);var a=new We(n);d(a),je.show.modelSummary(B,a.model)}},children:"Preprocess Image"})}),r?Object(D.jsx)($,{children:Object(D.jsxs)(_.a,{container:!0,item:!0,justify:"center",alignItems:"center",spacing:3,children:[Object(D.jsx)(_.a,{item:!0,children:Object(D.jsx)(K.a,{variant:"contained",color:"primary",onClick:function(e){b(!0),u.isTraining=!0,N(u.train(T,O,w))},children:"Train Model"})}),C?Object(D.jsx)(_.a,{item:!0,children:Object(D.jsx)(K.a,{variant:"contained",color:"secondary",onClick:function(e){u.isTraining=!1,b(!1),window.clearInterval(C),N(null),u.visualiseResult(T)},children:"Stop training"})}):null]})}):null,Object(D.jsx)("canvas",{ref:T}),f?Object(D.jsxs)(g.a,{children:["Epoch: ",f,"           Loss:",y]}):null]})}function Ee(){var e=Object(a.useState)(null),t=Object(c.a)(e,2),n=t[0],i=t[1],r=Object(a.useRef)(null),s=Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)(g.a,{variant:"h4",gutterBottom:!0,children:"Cellular Automata in Nature"}),Object(D.jsxs)(Y,{children:[Object(D.jsx)("a",{href:"https://link.springer.com/article/10.1007/BF02459572",children:"Partial Diffrential Equation"})," was suggested as a useful tool for modeling simple physical processes of reaction and diffusion by British mathematician Alan Turing. These simple reaction-diffusion processes regulated by cell-to-cell communication mechanisms like bioelectric signallings or chemical graidents, in turns, produce the beautiful patterns we see on animal skins, plants etc.",Object(D.jsx)("br",{}),Object(D.jsx)("br",{}),'You can upload a image file which ideally contains a pattern like the example giraffe pattern we have provided. Once you can see the image successfully uploaded with a preview showing, or if you prefer to just use the exmaple image we provided, you can go ahead and click "preprocess image" on the other panel for the machine learning model.']}),Object(D.jsx)(Ae,{textureImage:n,setTextureImage:i,uploadedImage:r})]}),o=Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)(g.a,{variant:"h4",gutterBottom:!0,children:"Texture Synthesis"}),Object(D.jsxs)(Y,{children:[Object(D.jsx)("a",{href:"https://distill.pub/2020/growing-ca/",children:"Neural Cellular Automata"}),' is an cutting edge research field in machine learning that combines cellular automata and recurrent neural networks to simulate the natural dynamical systems with self-organising properties. Proposed by researchers at Google and Allen Discovery Center at Tufts University, the model can simulate the natural process of pattern formation and shows suprising "self-healing" properties.',Object(D.jsx)("br",{}),Object(D.jsx)("br",{}),"Below is an example implementation of an in-browser neural cellular automata networks. Due to the limitations of the javascript serverless architecture and Tensorflow.js, there are still some performance issues and training results have been sub-optimal."]}),Object(D.jsx)(Ge,{uploadedImage:r})]});return Object(D.jsx)(H,{left:s,right:o})}function Pe(){var e=je.visor();e.el.style.position="absolute",e.el.style.zIndex=2e3,e.el.children[0].style.maxWidth="100%",e.close()}var De=240,Ye=Object(d.a)((function(e){return{root:{display:"flex"},appBar:{zIndex:e.zIndex.drawer+1,transition:e.transitions.create(["width","margin"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},appBarShift:{marginLeft:De,width:"calc(100% - ".concat(De,"px)"),transition:e.transitions.create(["width","margin"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen})},menuButton:{marginRight:36},hide:{display:"none"},drawer:{width:De,flexShrink:0,whiteSpace:"nowrap"},drawerOpen:{width:De,transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen})},drawerClose:Object(l.a)({transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),overflowX:"hidden",width:e.spacing(7)+1},e.breakpoints.up("sm"),{width:e.spacing(9)+1}),toolbar:Object(o.a)({display:"flex",alignItems:"center",justifyContent:"flex-end",padding:e.spacing(0,1)},e.mixins.toolbar),content:{flexGrow:1,padding:e.spacing(3)}}}));function Xe(){var e,t,n=Ye(),i=Object(j.a)(),r=Object(a.useState)(!1),s=Object(c.a)(r,2),o=s[0],d=s[1];Object(a.useEffect)(Pe);return Object(D.jsxs)("div",{className:n.root,children:[Object(D.jsx)(f.a,{}),Object(D.jsx)(b.a,{position:"fixed",className:Object(u.a)(n.appBar,Object(l.a)({},n.appBarShift,o)),children:Object(D.jsxs)(m.a,{children:[Object(D.jsx)(x.a,{color:"inherit","aria-label":"open drawer",onClick:function(e){e.preventDefault(),d(!0)},edge:"start",className:Object(u.a)(n.menuButton,Object(l.a)({},n.hide,o)),children:Object(D.jsx)(y.a,{})}),Object(D.jsx)(g.a,{variant:"h6",noWrap:!0,children:"CA-ML Webapp Demo"})]})}),Object(D.jsxs)(h.a,{variant:"permanent",className:Object(u.a)(n.drawer,(e={},Object(l.a)(e,n.drawerOpen,o),Object(l.a)(e,n.drawerClose,!o),e)),classes:{paper:Object(u.a)((t={},Object(l.a)(t,n.drawerOpen,o),Object(l.a)(t,n.drawerClose,!o),t))},children:[Object(D.jsx)("div",{className:n.toolbar,children:Object(D.jsx)(x.a,{onClick:function(e){e.preventDefault(),d(!1)},children:"rtl"===i.direction?Object(D.jsx)(C.a,{}):Object(D.jsx)(S.a,{})})}),Object(D.jsx)(O.a,{}),Object(D.jsxs)(p.a,{children:[Object(D.jsxs)(N.a,{button:!0,component:G.b,to:"/",children:[Object(D.jsxs)(T.a,{children:[" ",Object(D.jsx)(I.a,{})," "]}),Object(D.jsx)(B.a,{primary:"Introduction"})]},"Intro"),Object(D.jsxs)(N.a,{button:!0,component:G.b,to:"/elementary",children:[Object(D.jsxs)(T.a,{children:[" ",Object(D.jsx)(L.a,{})," "]}),Object(D.jsx)(B.a,{primary:"Elementary CA"})]},"elementary"),Object(D.jsxs)(N.a,{button:!0,component:G.b,to:"/gol",children:[Object(D.jsxs)(T.a,{children:[" ",Object(D.jsx)(F.a,{})," "]}),Object(D.jsx)(B.a,{primary:"Game of Life"})]},"gol"),Object(D.jsxs)(N.a,{button:!0,component:G.b,to:"/texture",children:[Object(D.jsxs)(T.a,{children:[" ",Object(D.jsx)(W.a,{})," "]}),Object(D.jsx)(B.a,{primary:"Texture Synthesis"})]},"texture_synthesis")]})]}),Object(D.jsxs)("main",{className:n.content,children:[Object(D.jsx)("div",{className:n.toolbar}),Object(D.jsxs)(E.c,{children:[Object(D.jsx)(E.a,{exact:!0,path:"/",component:function(){return Object(D.jsx)(V,{})}}),Object(D.jsx)(E.a,{exact:!0,path:"/elementary",component:function(){return Object(D.jsx)(Oe,{})}}),Object(D.jsx)(E.a,{exact:!0,path:"/gol",component:function(){return Object(D.jsx)(Ie,{})}}),Object(D.jsx)(E.a,{exact:!0,path:"/texture",component:function(){return Object(D.jsx)(Ee,{})}})]})]})]})}var _e=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,638)).then((function(t){var n=t.getCLS,a=t.getFID,i=t.getFCP,r=t.getLCP,s=t.getTTFB;n(e),a(e),i(e),r(e),s(e)}))};s.a.render(Object(D.jsx)(i.a.StrictMode,{children:Object(D.jsx)(G.a,{children:Object(D.jsx)(Xe,{})})}),document.getElementById("root")),_e()}},[[554,1,2]]]);
//# sourceMappingURL=main.c2163726.chunk.js.map